# üó∫Ô∏è PROJECT_MAP.md ‚Äî CVD Risk Assessment System (v1.2)

> **–î–ª—è –∞–≥–µ–Ω—Ç–æ–≤:** –≠—Ç–æ –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ –ø—Ä–∞–≤–¥—ã –æ–± –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ. –ü–µ—Ä–µ–¥ –ª—é–±—ã–º –∏–∑–º–µ–Ω–µ–Ω–∏–µ–º ‚Äî –ø—Ä–æ—á–∏—Ç–∞—Ç—å. –ü–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è ‚Äî –æ–±–Ω–æ–≤–∏—Ç—å —ç—Ç–æ—Ç —Ñ–∞–π–ª.
> –Ø–∑—ã–∫ –æ–±—â–µ–Ω–∏—è: **–†—É—Å—Å–∫–∏–π**. –ö–æ–¥: **–ê–Ω–≥–ª–∏–π—Å–∫–∏–π**.

## 1. –ù–ê–ó–ù–ê–ß–ï–ù–ò–ï –ò –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–¨

–ö–ª–∏–Ω–∏—á–µ—Å–∫–∞—è –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ —Å–∫—Ä–∏–Ω–∏–Ω–≥–∞ –°–°–ó. **–ù–µ –∑–∞–º–µ–Ω—è–µ—Ç –≤—Ä–∞—á–∞**.

* **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** Safety > Clinical Correctness > Data Integrity > Explainability > UX > Performance.
* **–ì–ª–∞–≤–Ω–æ–µ –ø—Ä–∞–≤–∏–ª–æ:** –õ—é–±–æ–π –≤—ã–≤–æ–¥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é **–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ** –≤–∫–ª—é—á–∞–µ—Ç –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–π –¥–∏—Å–∫–ª–µ–π–º–µ—Ä.

## 2. –ê–ì–ï–ù–¢–ù–ê–Ø –ò–ï–†–ê–†–•–ò–Ø

| –ê–≥–µ–Ω—Ç | –°—Ñ–µ—Ä–∞ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏ | –ó–∞–ø—Ä–µ—â–µ–Ω–æ |
| --- | --- | --- |
| **Lead Agent** | –í–∞–ª–∏–¥–∞—Ü–∏—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã, —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤, —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –ø–æ—Ä–æ–≥–æ–≤. | –ü–∏—Å–∞—Ç—å –∫–æ–¥, –º–µ–Ω—è—Ç—å –º–æ–¥–µ–ª–∏, –¥–µ–ø–ª–æ–∏—Ç—å. |
| **Data Scientist** | –û–±—É—á–µ–Ω–∏–µ, –∫–∞–ª–∏–±—Ä–æ–≤–∫–∞, –º–µ—Ç—Ä–∏–∫–∏ (ROC-AUC, Sensitivity), SHAP. | –î–µ–ø–ª–æ–π, –Ω–∞–ø–∏—Å–∞–Ω–∏–µ API, –∏–∑–º–µ–Ω–µ–Ω–∏–µ UI. |
| **Backend Agent** | API (FastAPI), –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å (CORS/Auth), –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏, Docker. | –ò–∑–º–µ–Ω–µ–Ω–∏–µ –ª–æ–≥–∏–∫–∏ ML, –∏–∑–º–µ–Ω–µ–Ω–∏–µ –ø–æ—Ä–æ–≥–æ–≤ —Ä–∏—Å–∫–∞. |
| **Bot Agent** | FSM –¥–∏–∞–ª–æ–≥, —Å–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö, –≤–∞–ª–∏–¥–∞—Ü–∏—è –≤–≤–æ–¥–∞ (aiogram). | –ú–µ–¥–∏—Ü–∏–Ω—Å–∫–∞—è –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è, —Å–º–µ–Ω–∞ –ø–æ—Ä–æ–≥–æ–≤. |
| **Frontend Agent** | UI/UX, –≥—Ä–∞—Ñ–∏–∫–∏ (Charts.js), –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è (RU/EN/KR). | –ò–∑–º–µ–Ω–µ–Ω–∏–µ –ª–æ–≥–∏–∫–∏ —Ä–∞—Å—á—ë—Ç–∞, –¥–æ—Å—Ç—É–ø –∫ –ë–î. |

## 3. –§–ê–ô–õ–û–í–ê–Ø –ö–ê–†–¢–ê –ü–†–û–ï–ö–¢–ê (–¢–µ–∫—É—â–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞)

```text
cvd-risk-api/
‚îÇ
‚îú‚îÄ‚îÄ app/                          ‚Üê –ó–û–ù–ê: Backend Agent
‚îÇ   ‚îú‚îÄ‚îÄ main.py                   ‚Üê Entry point. API routes, middleware, startup
‚îÇ   ‚îú‚îÄ‚îÄ schemas.py                ‚Üê Pydantic: PatientInput, PredictionResponse
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ risk_logic.py             ‚Üê –Ø–î–†–û –ø–∞–π–ø–ª–∞–π–Ω–∞. evaluate_clinical_risk()
‚îÇ   ‚îú‚îÄ‚îÄ safety.py                 ‚Üê –ö–ª–∏–Ω–∏—á–µ—Å–∫–∏–µ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è (3 —Ñ—É–Ω–∫—Ü–∏–∏)
‚îÇ   ‚îú‚îÄ‚îÄ audit.py                  ‚Üê build_audit_block(): timestamp, request_id
‚îÇ   ‚îú‚îÄ‚îÄ risk_card.py              ‚Üê build_risk_card(): –∫–∞—Ä—Ç–æ—á–∫–∞ –¥–ª—è –≤—Ä–∞—á–∞
‚îÇ   ‚îú‚îÄ‚îÄ clinical_mapping.py       ‚Üê CLINICAL_FEATURE_MAP, —Ç–µ–∫—Å—Ç–æ–≤—ã–µ –æ–ø–∏—Å–∞–Ω–∏—è
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ shap_explainer.py         ‚Üê –ó–û–ù–ê: Data Scientist (—Ç–æ–ª—å–∫–æ —á—Ç–µ–Ω–∏–µ)
‚îÇ   ‚îú‚îÄ‚îÄ shap_interpreter.py       ‚Üê interpret_shap(): SHAP ‚Üí –∫–ª–∏–Ω–∏—á–µ—Å–∫–∞—è –ª–æ–≥–∏–∫–∞
‚îÇ   ‚îú‚îÄ‚îÄ model_loader.py           ‚Üê load_model(), get_model_performance_metrics()
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ localization.py           ‚Üê i18n: t(lang, section, key) ‚Äî 35KB –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏–∏
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ core/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ config.py             ‚Üê Settings (pydantic_settings). .env ‚Üí –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ logging.py            ‚Üê setup_logging(), logger instance
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ exceptions.py        ‚Üê –ö–∞—Å—Ç–æ–º–Ω—ã–µ –∏—Å–∫–ª—é—á–µ–Ω–∏—è (–∑–∞–≥–æ—Ç–æ–≤–∫–∞)
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ api/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ dependencies.py      ‚Üê get_model(), get_shap_explainer() —Å @lru_cache
‚îÇ   ‚îÇ
‚îÇ   ‚îî‚îÄ‚îÄ services/
‚îÇ       ‚îú‚îÄ‚îÄ prediction_service.py ‚Üê PredictionService class (—Å–µ—Ä–≤–∏—Å–Ω—ã–π —Å–ª–æ–π)
‚îÇ       ‚îî‚îÄ‚îÄ google_sheets.py     ‚Üê GoogleSheetsService: –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å —Å–æ–≥–ª–∞—Å–∏—è
‚îÇ
‚îú‚îÄ‚îÄ bot/                          ‚Üê –ó–û–ù–ê: Bot Agent
‚îÇ   ‚îú‚îÄ‚îÄ main.py                   ‚Üê –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞. Bot + Dispatcher + —Ä–æ—É—Ç–µ—Ä—ã
‚îÇ   ‚îú‚îÄ‚îÄ config.py                 ‚Üê BOT_TOKEN, API_BASE_URL (–∏–∑ .env)
‚îÇ   ‚îú‚îÄ‚îÄ states.py                 ‚Üê RiskForm(StatesGroup): 16 —Å–æ—Å—Ç–æ—è–Ω–∏–π FSM
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ handlers/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ common.py            ‚Üê /start, –≤—ã–±–æ—Ä —è–∑—ã–∫–∞, –≤—ã–±–æ—Ä —Ä–µ–≥–∏–æ–Ω–∞
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ form.py              ‚Üê –í–µ—Å—å —Å–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö: DOB‚Üígender‚Üí...‚Üíconsent
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ services/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ api_client.py        ‚Üê get_risk_prediction(data) ‚Üí POST /predict
‚îÇ   ‚îÇ
‚îÇ   ‚îî‚îÄ‚îÄ utils/
‚îÇ       ‚îú‚îÄ‚îÄ localization.py      ‚Üê bot_i18n: t(lang, key) –¥–ª—è –±–æ—Ç–∞
‚îÇ       ‚îî‚îÄ‚îÄ user_stats.py        ‚Üê StatsManager: –ª–∏–º–∏—Ç—ã (10/–¥–µ–Ω—å, cooldown 30—Å)
‚îÇ
‚îú‚îÄ‚îÄ frontend/                     ‚Üê –ó–û–ù–ê: Frontend Agent
‚îÇ   ‚îú‚îÄ‚îÄ index.html               ‚Üê SPA, –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π HTML —Ñ–∞–π–ª
‚îÇ   ‚îú‚îÄ‚îÄ styles.css               ‚Üê –í—Å–µ —Å—Ç–∏–ª–∏
‚îÇ   ‚îî‚îÄ‚îÄ js/
‚îÇ       ‚îú‚îÄ‚îÄ config.js            ‚Üê –ü–æ—Ä–æ–≥–∏ —Ä–∏—Å–∫–∞, URL API, feature flags
‚îÇ       ‚îú‚îÄ‚îÄ i18n.js              ‚Üê –ü–µ—Ä–µ–≤–æ–¥—ã EN/RU/KR –¥–ª—è UI
‚îÇ       ‚îú‚îÄ‚îÄ api-service.js       ‚Üê fetch –∫ /predict, —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è —Ñ–æ—Ä–º
‚îÇ       ‚îú‚îÄ‚îÄ dashboard.js         ‚Üê –ì–ª–∞–≤–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä: —Ñ–æ—Ä–º–∞ ‚Üí API ‚Üí —Ä–µ–Ω–¥–µ—Ä
‚îÇ       ‚îú‚îÄ‚îÄ charts.js            ‚Üê Chart.js: gauge, radar, bar
‚îÇ       ‚îú‚îÄ‚îÄ validation.js        ‚Üê –ö–ª–∏–µ–Ω—Ç—Å–∫–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è —Ñ–æ—Ä–º
‚îÇ       ‚îú‚îÄ‚îÄ riskGauge.js         ‚Üê SVG —Å–ø–∏–¥–æ–º–µ—Ç—Ä —Ä–∏—Å–∫–∞
‚îÇ       ‚îú‚îÄ‚îÄ report-utils.js      ‚Üê –£—Ç–∏–ª–∏—Ç—ã –¥–ª—è –æ—Ç—á—ë—Ç–æ–≤
‚îÇ       ‚îú‚îÄ‚îÄ render/
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ patient-report.js  ‚Üê –†–µ–Ω–¥–µ—Ä –∫–∞—Ä—Ç–æ—á–∫–∏ –ø–∞—Ü–∏–µ–Ω—Ç–∞
‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ doctor-report.js   ‚Üê –†–µ–Ω–¥–µ—Ä –∫–∞—Ä—Ç–æ—á–∫–∏ –≤—Ä–∞—á–∞
‚îÇ       ‚îî‚îÄ‚îÄ utils/
‚îÇ           ‚îú‚îÄ‚îÄ form-handlers.js
‚îÇ           ‚îú‚îÄ‚îÄ interpretation.js  ‚Üê –¢–µ–∫—Å—Ç–æ–≤–∞—è –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
‚îÇ           ‚îú‚îÄ‚îÄ normalization.js
‚îÇ           ‚îî‚îÄ‚îÄ warnings.js
‚îÇ
‚îú‚îÄ‚îÄ model/                        ‚Üê –ó–û–ù–ê: Data Scientist (readonly –¥–ª—è –æ—Å—Ç–∞–ª—å–Ω—ã—Ö)
‚îÇ   ‚îú‚îÄ‚îÄ improved_catboost.cbm    ‚Üê –û—Å–Ω–æ–≤–Ω–∞—è –º–æ–¥–µ–ª—å (CatBoost, 475KB)
‚îÇ   ‚îú‚îÄ‚îÄ calibrated_catboost.pkl  ‚Üê –ö–∞–ª–∏–±—Ä–æ–≤–∞–Ω–Ω–∞—è –º–æ–¥–µ–ª—å (12MB, —Ä–µ–∑–µ—Ä–≤)
‚îÇ   ‚îú‚îÄ‚îÄ shap_background_catboost_clean.csv  ‚Üê SHAP reference dataset
‚îÇ   ‚îú‚îÄ‚îÄ shap_background_catboost.npy        ‚Üê SHAP numpy —Ñ–æ—Ä–º–∞—Ç
‚îÇ   ‚îú‚îÄ‚îÄ model_metrics.json       ‚Üê ROC-AUC=0.799, sensitivity=0.90, threshold=0.2673
‚îÇ   ‚îî‚îÄ‚îÄ clinical_paradoxes.json  ‚Üê –ó–∞–¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∫–ª–∏–Ω–∏—á–µ—Å–∫–∏–µ –∞–Ω–æ–º–∞–ª–∏–∏
‚îÇ
‚îú‚îÄ‚îÄ .agent/                       ‚Üê –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∞–≥–µ–Ω—Ç–æ–≤ (–Ω–µ —Ç—Ä–æ–≥–∞—Ç—å –±–µ–∑ Lead Agent)
‚îÇ   ‚îú‚îÄ‚îÄ AGENT_ARCHITECTURE.md
‚îÇ   ‚îú‚îÄ‚îÄ _GLOBAL_RULES.md         ‚Üê –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞ –≤—Å–µ–π —Å–∏—Å—Ç–µ–º—ã
‚îÇ   ‚îú‚îÄ‚îÄ lead_agent.md
‚îÇ   ‚îú‚îÄ‚îÄ backend_agent.md
‚îÇ   ‚îú‚îÄ‚îÄ frontend_agent.md
‚îÇ   ‚îú‚îÄ‚îÄ bot_agent.md
‚îÇ   ‚îú‚îÄ‚îÄ data_scientist.md
‚îÇ   ‚îî‚îÄ‚îÄ rules/
‚îÇ       ‚îî‚îÄ‚îÄ GEMINI.md            ‚Üê –°–∏—Å—Ç–µ–º–Ω—ã–µ –¥–∏—Ä–µ–∫—Ç–∏–≤—ã –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏–∏
‚îÇ
‚îú‚îÄ‚îÄ docs/
‚îÇ   ‚îú‚îÄ‚îÄ README_CLINICAL_VALIDATION_EN.md
‚îÇ   ‚îú‚îÄ‚îÄ README_CLINICAL_VALIDATION_RU.md
‚îÇ   ‚îî‚îÄ‚îÄ README_CLINICAL_VALIDATION_KR.md
‚îÇ
‚îú‚îÄ‚îÄ CVD_risk_dataset.csv         ‚Üê –ò—Å—Ö–æ–¥–Ω—ã–π –¥–∞—Ç–∞—Å–µ—Ç (3.2MB, ~70k –∑–∞–ø–∏—Å–µ–π)
‚îú‚îÄ‚îÄ train_improved_model.py      ‚Üê –°–∫—Ä–∏–ø—Ç –æ–±—É—á–µ–Ω–∏—è –º–æ–¥–µ–ª–∏
‚îú‚îÄ‚îÄ requirements.txt             ‚Üê –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ Python
‚îî‚îÄ‚îÄ .env                         ‚Üê –°–µ–∫—Ä–µ—Ç—ã (–ù–ï –≤ git)

```
## 4. –¶–ï–ù–¢–†–ê–õ–¨–ù–´–ô –ü–ê–ô–ü–õ–ê–ô–ù (evaluate_clinical_risk)

> –§–∞–π–ª: `app/risk_logic.py`  
> –ê–≥–µ–Ω—Ç-–≤–ª–∞–¥–µ–ª–µ—Ü: **Backend Agent** (–ª–æ–≥–∏–∫–∞) / **Data Scientist** (–ø–æ—Ä–æ–≥–∏, –≤–µ—Å–∞)

```
PatientInput (Pydantic)
       ‚îÇ
       ‚ñº
[1] –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Ñ–∏—á
    age_days = age_years √ó 365.25
    bmi = weight / (height/100)¬≤
    features = [age, gender, height, weight,
                ap_hi, ap_lo, cholesterol, gluc,
                smoke, alco, active, bmi]
       ‚îÇ
       ‚ñº
[2] ML Prediction
    model.predict_proba(features)[0, 1]
    ‚Üí risk_proba (float, 0‚Äì1)
       ‚îÇ
       ‚ñº
[3] –ö–∞—Ç–µ–≥–æ—Ä–∏–∑–∞—Ü–∏—è —Ä–∏—Å–∫–∞
    < 0.15          ‚Üí "low"
    0.15 ‚Äì 0.2673   ‚Üí "moderate"
    ‚â• 0.2673        ‚Üí "high"
    (–ø–æ—Ä–æ–≥ 0.2673 = 90% sensitivity)
       ‚îÇ
       ‚ñº
[4] Confidence
    distance = |risk_proba - 0.2673|
    ‚â• 0.10 ‚Üí "high"
    ‚â• 0.04 ‚Üí "moderate"
    < 0.04 ‚Üí "low"
       ‚îÇ
       ‚ñº
[5] Safety Warnings (app/safety.py)
    ‚Ä¢ age < 40       ‚Üí –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –æ –º–æ–ª–æ–¥–æ–º –≤–æ–∑—Ä–∞—Å—Ç–µ
    ‚Ä¢ ap_hi > 200    ‚Üí —ç–∫—Å—Ç—Ä–µ–º–∞–ª—å–Ω–æ–µ –¥–∞–≤–ª–µ–Ω–∏–µ
    ‚Ä¢ bmi > 50       ‚Üí —ç–∫—Å—Ç—Ä–µ–º–∞–ª—å–Ω—ã–π –ò–ú–¢
    ‚Ä¢ bmi < 18.5     ‚Üí –Ω–µ–¥–æ–≤–µ—Å
    ‚Ä¢ age > 85       ‚Üí –æ—á–µ–Ω—å –ø–æ–∂–∏–ª–æ–π
    ‚Ä¢ confidence=low ‚Üí –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –æ –Ω–µ–æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ—Å—Ç–∏
       ‚îÇ
       ‚ñº
[6] SHAP –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ (shap_explainer ‚Üí shap_interpreter)
    explain_patient() ‚Üí shap_values
    interpret_shap()  ‚Üí —Å–ø–∏—Å–æ–∫ —Ñ–∞–∫—Ç–æ—Ä–æ–≤ —Å –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ–º
       ‚îÇ
       ‚îú‚îÄ [6.2] –ü–æ–≤–µ–¥–µ–Ω—á–µ—Å–∫–∏–µ —Ñ–∞–∫—Ç–æ—Ä—ã (rule-based)
       ‚îÇ   smoke=1, gluc=3, alco=1, active=0
       ‚îÇ
       ‚îú‚îÄ [6.3] –ü–æ—Ä–æ–≥–æ–≤—ã–µ —Ñ–ª–∞–≥–∏
       ‚îÇ   ap_hi ‚â• 140 ‚Üí "high_bp"
       ‚îÇ   bmi ‚â• 30    ‚Üí "obesity"
       ‚îÇ   cholesterol=2 ‚Üí "cholesterol_attention"
       ‚îÇ   cholesterol=3 ‚Üí "cholesterol_high"
       ‚îÇ
       ‚îî‚îÄ –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ CLINICAL_PRIORITY (1=high_bp ... 12=active)
       ‚îÇ
       ‚ñº
[7] Risk Card (app/risk_card.py)
    headline + summary + key_factors[:3] + clinical_summary
       ‚îÇ
       ‚ñº
[8] Audit Block (app/audit.py)
    timestamp (UTC) + model_version + request_id (uuid4) + api_version
       ‚îÇ
       ‚ñº
PredictionResponse (JSON)
```
## 5. –¢–ï–•–ù–ò–ß–ï–°–ö–ò–ï –°–¢–ê–ù–î–ê–†–¢–´ –ò –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–¨

### üîí –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ (–í–∞–∂–Ω–æ –¥–ª—è Railway)

1. **CORS:** –í `app/main.py` —Ä–∞–∑—Ä–µ—à–µ–Ω—ã —Ç–æ–ª—å–∫–æ –¥–æ–º–µ–Ω—ã —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞. `allow_origins=["*"]` –∑–∞–º–µ–Ω—è–µ—Ç—Å—è –Ω–∞ —Å–ø–∏—Å–æ–∫ –∏–∑ `.env`.
2. **–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è:** –î–æ–±–∞–≤–ª–µ–Ω `X-Internal-Key`. –ë–æ—Ç –∏ –§—Ä–æ–Ω—Ç–µ–Ω–¥ –¥–æ–ª–∂–Ω—ã –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å —ç—Ç–æ—Ç –∫–ª—é—á –≤ –∑–∞–≥–æ–ª–æ–≤–∫–∞—Ö –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ `/predict`.
3. **Data Ethics:** –î–∞–Ω–Ω—ã–µ –≤ Google Sheets –ø–æ–ø–∞–¥–∞—é—Ç —Ç–æ–ª—å–∫–æ –≤ –∞–Ω–æ–Ω–∏–º–Ω–æ–º –≤–∏–¥–µ –ø–æ—Å–ª–µ —Å–æ–≥–ª–∞—Å–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (`consent`).

### üß† ML & SHAP –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

* **–ü–æ—Ä—è–¥–æ–∫ —Ñ–∏—á:** –°—Ç—Ä–æ–≥–æ 12 –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ (–æ—Ç `age` –¥–æ `bmi`). –ò–∑–º–µ–Ω–µ–Ω–∏–µ –ø–æ—Ä—è–¥–∫–∞ —Ç—Ä–µ–±—É–µ—Ç —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ DS –∏ Backend –∞–≥–µ–Ω—Ç–æ–≤.
* **–ü–æ—Ä–æ–≥ —Ä–∏—Å–∫–∞:** `HIGH_RISK_THRESHOLD = 0.2673` (–æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç 90% —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –¥–ª—è —Å–∫—Ä–∏–Ω–∏–Ω–≥–∞).

## 6. –ü–†–û–¢–û–ö–û–õ –≠–°–ö–ê–õ–ê–¶–ò–ò –ö LEAD AGENT

–ê–≥–µ–Ω—Ç –æ–±—è–∑–∞–Ω –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å—Å—è –∏ –∑–∞–ø—Ä–æ—Å–∏—Ç—å –≤–º–µ—à–∞—Ç–µ–ª—å—Å—Ç–≤–æ Lead Agent –≤ —Å–ª—É—á–∞—è—Ö:

* –ò–∑–º–µ–Ω–µ–Ω–∏—è –ø–æ—Ä–æ–≥–∞ —Ä–∏—Å–∫–∞ –∏–ª–∏ –ª–æ–≥–∏–∫–∏ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏.
* –ü–æ–ø—ã—Ç–∫–∏ –æ–¥–Ω–æ–≥–æ –∞–≥–µ–Ω—Ç–∞ –∏–∑–º–µ–Ω–∏—Ç—å —Ñ–∞–π–ª—ã –≤ –∑–æ–Ω–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏ –¥—Ä—É–≥–æ–≥–æ.
* –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –∫–ª–∏–Ω–∏—á–µ—Å–∫–∏—Ö –∞–Ω–æ–º–∞–ª–∏–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Ä–∏—Å–∫ –ø–∞–¥–∞–µ—Ç –ø—Ä–∏ —Ä–æ—Å—Ç–µ –¥–∞–≤–ª–µ–Ω–∏—è).
* –ò–∑–º–µ–Ω–µ–Ω–∏—è —Ç–µ–∫—Å—Ç–∞ –º–µ–¥–∏—Ü–∏–Ω—Å–∫–æ–≥–æ –¥–∏—Å–∫–ª–µ–π–º–µ—Ä–∞.

### üìã –ß–ï–ö-–õ–ò–°–¢ –ü–ï–†–ï–î –î–ï–ü–õ–û–ï–ú (–î–ª—è Lead Agent)

* [ ] –ö–ª—é—á `X-Internal-Key` –Ω–∞—Å—Ç—Ä–æ–µ–Ω –≤ `.env` –Ω–∞ Railway –∏ –≤ –∫–æ–¥–µ.
* [ ] –§–∞–π–ª `improved_catboost.cbm` –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç –≤ –ø–∞–ø–∫–µ `model/`.
* [ ] –í—Å–µ 16 —Å–æ—Å—Ç–æ—è–Ω–∏–π FSM –≤ –±–æ—Ç–µ —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç `consent`.
* [ ] –õ–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è UI/–ë–æ—Ç –ø—Ä–æ–≤–µ—Ä–µ–Ω–∞ –¥–ª—è –≤—Å–µ—Ö —è–∑—ã–∫–æ–≤ (RU/EN/KR).

*–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ: 2026-02-17. –û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π: Lead Agent.*


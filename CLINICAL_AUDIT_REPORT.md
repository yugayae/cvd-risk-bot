# –ö–ª–∏–Ω–∏—á–µ—Å–∫–∏–π –∞—É–¥–∏—Ç –º–æ–¥–µ–ª–∏ –æ—Ü–µ–Ω–∫–∏ —Å–µ—Ä–¥–µ—á–Ω–æ-—Å–æ—Å—É–¥–∏—Å—Ç–æ–≥–æ —Ä–∏—Å–∫–∞

## 1. –†–µ–∑—é–º–µ

–ü—Ä–æ–≤–µ–¥—ë–Ω –∫–ª–∏–Ω–∏—á–µ—Å–∫–∏–π –∞—É–¥–∏—Ç —Å–∏—Å—Ç–µ–º—ã –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –ø—Ä–∏–Ω—è—Ç–∏—è –≤—Ä–∞—á–µ–±–Ω—ã—Ö —Ä–µ—à–µ–Ω–∏–π (CDSS) –¥–ª—è –æ—Ü–µ–Ω–∫–∏ —Å–µ—Ä–¥–µ—á–Ω–æ-—Å–æ—Å—É–¥–∏—Å—Ç–æ–≥–æ —Ä–∏—Å–∫–∞ (–°–°–†). –°–∏—Å—Ç–µ–º–∞ –æ—Å–Ω–æ–≤–∞–Ω–∞ –Ω–∞ –º–æ–¥–µ–ª–∏ CatBoost —Å SHAP-–∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏–µ–π –∏ –º–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤–æ–π –∫–ª–∏–Ω–∏—á–µ—Å–∫–æ–π –∫–æ—Ä—Ä–µ–∫—Ü–∏–µ–π.

> [!IMPORTANT]
> **–û–±—â–∏–π –≤–µ—Ä–¥–∏–∫—Ç**: –õ–æ–≥–∏–∫–∞ —Ä–∞—Å—á—ë—Ç–∞ –º–æ–¥–µ–ª–∏ **–∫–ª–∏–Ω–∏—á–µ—Å–∫–∏ –ø—Ä–∞–≤–¥–æ–ø–æ–¥–æ–±–Ω–∞** –∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –ø—Ä–∏–Ω—Ü–∏–ø–∞–º –¥–æ–∫–∞–∑–∞—Ç–µ–ª—å–Ω–æ–π –∫–∞—Ä–¥–∏–æ–ª–æ–≥–∏–∏. –ù–∏–∂–µ ‚Äî –æ–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ –ø–æ –∫–∞–∂–¥–æ–º—É –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—É –∏ –≤—ã—è–≤–ª–µ–Ω–Ω—ã–µ —Ç–æ—á–∫–∏ –¥–ª—è —É—Å–∏–ª–µ–Ω–∏—è.

---

## 2. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∫–ª–∏–Ω–∏—á–µ—Å–∫–æ–≥–æ –ø–∞–π–ø–ª–∞–π–Ω–∞

```mermaid
graph TD
    A[–í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –ø–∞—Ü–∏–µ–Ω—Ç–∞] --> B[–í–∞–ª–∏–¥–∞—Ü–∏—è Pydantic]
    B --> C[Feature Engineering ‚Äî BMI]
    C --> D[CatBoost predict_proba]
    D --> E[–ö–∞—Ç–µ–≥–æ—Ä–∏–∑–∞—Ü–∏—è —Ä–∏—Å–∫–∞]
    D --> F[–û—Ü–µ–Ω–∫–∞ —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏]
    D --> G[SHAP-–æ–±—ä—è—Å–Ω–µ–Ω–∏–µ]
    G --> H[–ö–ª–∏–Ω–∏—á–µ—Å–∫–∞—è –∫–æ—Ä—Ä–µ–∫—Ü–∏—è SHAP]
    E --> I[Rule-based —Ñ–ª–∞–≥–∏]
    I --> J[–ö–ª–∏–Ω–∏—á–µ—Å–∫–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è]
    H --> K[–û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ —Ñ–∞–∫—Ç–æ—Ä–æ–≤]
    J --> K
    F --> L[Safety Warnings]
    K --> M[Risk Card]
    M --> N[–§–∏–Ω–∞–ª—å–Ω—ã–π Clinical-grade JSON]
    L --> N
```

**–û—Ü–µ–Ω–∫–∞**: –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞ ‚Äî –º–Ω–æ–≥–æ—Å–ª–æ–π–Ω—ã–π –ø–æ–¥—Ö–æ–¥ (ML ‚Üí SHAP ‚Üí –∫–ª–∏–Ω–∏—á–µ—Å–∫–∞—è –∫–æ—Ä—Ä–µ–∫—Ü–∏—è ‚Üí safety) —è–≤–ª—è–µ—Ç—Å—è **best practice** –¥–ª—è –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏—Ö CDSS (FDA Software as Medical Device guidelines).

---

## 3. –û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ –º–æ–¥–µ–ª–∏ –∏ –º–µ—Ç—Ä–∏–∫

### 3.1. CatBoost ‚Äî –≤—ã–±–æ—Ä –º–æ–¥–µ–ª–∏

| –ö—Ä–∏—Ç–µ—Ä–∏–π | –û—Ü–µ–Ω–∫–∞ |
|---|---|
| –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ | ‚úÖ CatBoost –Ω–∞—Ç–∏–≤–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –æ—Ä–¥–∏–Ω–∞–ª—å–Ω—ã–º–∏ (cholesterol 1-2-3, gluc 1-2-3) |
| –£—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å –∫ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—é | ‚úÖ early_stopping_rounds=50, eval_set |
| –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å | ‚úÖ –°–æ–≤–º–µ—Å—Ç–∏–º —Å SHAP TreeExplainer |
| –õ–∏—Ç–µ—Ä–∞—Ç—É—Ä–∞ | ‚úÖ CatBoost –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç ROC-AUC 0.78‚Äì0.83 –≤ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è—Ö CVD prediction (PMC, ResearchGate) |

### 3.2. –ú–µ—Ç—Ä–∏–∫–∏ –º–æ–¥–µ–ª–∏

| –ú–µ—Ç—Ä–∏–∫–∞ | –ó–Ω–∞—á–µ–Ω–∏–µ | –ö–ª–∏–Ω–∏—á–µ—Å–∫–∏–π –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π |
|---|---|---|
| **ROC-AUC** | 0.7989 | –°–æ–ø–æ—Å—Ç–∞–≤–∏–º–æ —Å ESC SCORE2 (C-index 0.67‚Äì0.81). –ü—Ä–∏–µ–º–ª–µ–º–æ –¥–ª—è —Å–∫—Ä–∏–Ω–∏–Ω–≥–∞ |
| **Sensitivity** | 90.0% | ‚úÖ –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç ‚Äî –Ω–µ –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å –±–æ–ª—å–Ω–æ–≥–æ (Safety First) |
| **Specificity** | 41.88% | ‚ö†Ô∏è –ù–∏–∑–∫–∞—è ‚Äî –º–Ω–æ–≥–æ –ª–æ–∂–Ω–æ–ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã—Ö |
| **Precision** | 60% | –ö–∞–∂–¥—ã–π 2.5-–π ¬´–≤—ã—Å–æ–∫–∏–π —Ä–∏—Å–∫¬ª ‚Äî –ª–æ–∂–Ω—ã–π |
| **F1-score** | 0.72 | –ë–∞–ª–∞–Ω—Å –ø—Ä–∏–µ–º–ª–µ–º –¥–ª—è —Å–∫—Ä–∏–Ω–∏–Ω–≥–æ–≤–æ–π –∑–∞–¥–∞—á–∏ |

> [!TIP]
> **–û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ –≤—ã–±–æ—Ä–∞ Sensitivity = 90%**: –í –∫–∞—Ä–¥–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–º —Å–∫—Ä–∏–Ω–∏–Ω–≥–µ –ø—Ä–∏–Ω—Ü–∏–ø **¬´–ª—É—á—à–µ –ø–µ—Ä–µ–≤—ã—è–≤–∏—Ç—å, —á–µ–º –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å¬ª** —è–≤–ª—è–µ—Ç—Å—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–æ–º. ESC Guidelines 2021 –ø–æ–¥—á—ë—Ä–∫–∏–≤–∞—é—Ç —á—Ç–æ –ø—Ä–∏ –ø–µ—Ä–≤–∏—á–Ω–æ–π –ø—Ä–æ—Ñ–∏–ª–∞–∫—Ç–∏–∫–µ –°–°–ó —Ü–µ–Ω–∞ –ø—Ä–æ–ø—É—â–µ–Ω–Ω–æ–≥–æ —Å–ª—É—á–∞—è (–∏–Ω—Ñ–∞—Ä–∫—Ç, –∏–Ω—Å—É–ª—å—Ç) –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –≤—ã—à–µ —Ü–µ–Ω—ã –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–≥–æ –æ–±—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è. –¶–µ–ª–µ–≤–∞—è —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å 90% –æ–±–æ—Å–Ω–æ–≤–∞–Ω–∞ –¥–ª—è —Å–∫—Ä–∏–Ω–∏–Ω–≥–æ–≤–æ–≥–æ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞ –ø–µ—Ä–≤–∏—á–Ω–æ–≥–æ –∑–≤–µ–Ω–∞.

### 3.3. –ü–æ—Ä–æ–≥ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏: 0.2673

**–ö–∞–∫ –ø–æ–ª—É—á–µ–Ω**: –ò–∑ ROC-–∫—Ä–∏–≤–æ–π ‚Äî —Ç–æ—á–∫–∞, –≥–¥–µ TPR ‚â• 0.90.

**–ö–ª–∏–Ω–∏—á–µ—Å–∫–∞—è –æ—Ü–µ–Ω–∫–∞**:
- –ü–æ—Ä–æ–≥ < 0.5 –∫–æ—Ä—Ä–µ–∫—Ç–µ–Ω –¥–ª—è —Å–∫—Ä–∏–Ω–∏–Ω–≥–∞ (–Ω–µ –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏)
- –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –ø–∞—Ä–∞–¥–∏–≥–º–µ ¬´overdiagnosis is safer than underdiagnosis¬ª –≤ –ø–µ—Ä–≤–∏—á–Ω–æ–π –ø—Ä–æ—Ñ–∏–ª–∞–∫—Ç–∏–∫–µ –°–°–ó
- –í [risk_logic.py](file:///c:/HomeWork/Medical/CVD_risk_Cat_Boost/cvd-risk-api/app/risk_logic.py#L29): `HIGH_RISK_THRESHOLD = 0.2673` ‚Äî –∑–Ω–∞—á–µ–Ω–∏–µ –ø—Ä–∏–≤—è–∑–∞–Ω–æ –∫ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º –∫–∞–ª–∏–±—Ä–æ–≤–∫–∏

---

---

## 4. –†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è

### 4.1. –ê–Ω–∞–ª–∏–∑ –∫–∞–ª–∏–±—Ä–æ–≤–∫–∏ (Calibration)

–î–ª—è –º–æ–¥–µ–ª–µ–π –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏—è —Ä–∏—Å–∫–∞ –∫–∞–ª–∏–±—Ä–æ–≤–∫–∞ (—Ç–æ—á–Ω–æ—Å—Ç—å –æ—Ü–µ–Ω–∫–∏ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏) –≤–∞–∂–Ω–µ–µ —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å–Ω–æ–π —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ (ROC-AUC).

| –ú–µ—Ç–∫–∞ | –ó–Ω–∞—á–µ–Ω–∏–µ | –ö–ª–∏–Ω–∏—á–µ—Å–∫–∏–π –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π |
|---|---|---|
| **Brier Score** | 0.1830 | –•–æ—Ä–æ—à–∏–π –ø–æ–∫–∞–∑–∞—Ç–µ–ª—å (–±–ª–∏–∂–µ –∫ 0 - –ª—É—á—à–µ). –£–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ –≤—ã—Å–æ–∫—É—é —Ç–æ—á–Ω–æ—Å—Ç—å –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä—É–µ–º—ã—Ö –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π. |
| **ECE (Expected Calibration Error)** | **0.0114** (1.1%) | ‚úÖ **–ü—Ä–µ–≤–æ—Å—Ö–æ–¥–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç.** –†–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–Ω—ã–º —Ä–∏—Å–∫–æ–º –∏ —Ä–µ–∞–ª—å–Ω–æ–π —á–∞—Å—Ç–æ—Ç–æ–π —Å–æ–±—ã—Ç–∏–π —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç –≤ —Å—Ä–µ–¥–Ω–µ–º –≤—Å–µ–≥–æ 1.1%. |

**Calibration Plot (–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è):**
–ú–æ–¥–µ–ª—å –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç –æ—Ç–ª–∏—á–Ω—É—é –∫–∞–ª–∏–±—Ä–æ–≤–∫—É –Ω–∞ –≤—Å—ë–º –¥–∏–∞–ø–∞–∑–æ–Ω–µ —Ä–∏—Å–∫–æ–≤, —Å –Ω–µ–±–æ–ª—å—à–æ–π —Ç–µ–Ω–¥–µ–Ω—Ü–∏–µ–π –∫ –ø–µ—Ä–µ–æ—Ü–µ–Ω–∫–µ —Ä–∏—Å–∫–∞ –≤ –æ–±–ª–∞—Å—Ç–∏ —ç–∫—Å—Ç—Ä–µ–º–∞–ª—å–Ω–æ –≤—ã—Å–æ–∫–∏—Ö –∑–Ω–∞—á–µ–Ω–∏–π (>90%), —á—Ç–æ –¥–æ–ø—É—Å—Ç–∏–º–æ –¥–ª—è —Å–∫—Ä–∏–Ω–∏–Ω–≥–∞.

### 4.2. –ê–Ω–∞–ª–∏–∑ –≤ –ø–æ–¥–≥—Ä—É–ø–ø–∞—Ö (Subgroup Analysis)

–†–µ–≥—É–ª—è—Ç–æ—Ä–Ω–æ–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–µ: –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏ —Ä–∞–±–æ—Ç—ã –º–æ–¥–µ–ª–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –¥–µ–º–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö –≥—Ä—É–ø–ø.

| –ì—Ä—É–ø–ø–∞ | –ö–æ–ª-–≤–æ (n) | ROC-AUC | Brier Score | ECE | –°—Ç–∞—Ç—É—Å |
|---|---|---|---|---|---|
| **–ñ–µ–Ω—â–∏–Ω—ã (Gender 1)** | 8,927 | 0.7976 | 0.1823 | 0.0101 | ‚úÖ –°—Ç–∞–±–∏–ª—å–Ω–æ |
| **–ú—É–∂—á–∏–Ω—ã (Gender 2)** | 4,796 | 0.7926 | 0.1844 | 0.0219 | ‚úÖ –°—Ç–∞–±–∏–ª—å–Ω–æ |
| **–ú–æ–ª–æ–¥—ã–µ (<45 –ª–µ—Ç)** | 1,927 | **0.8270** | 0.1317 | 0.0240 | ‚úÖ –í—ã—Å–æ–∫–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å |
| **–°—Ä–µ–¥–Ω–∏–π –≤–æ–∑—Ä–∞—Å—Ç (45-65)**| 11,796 | 0.7755 | 0.1914 | 0.0130 | ‚úÖ –í–∞–ª–∏–¥–Ω–æ |

> [!NOTE]
> –ú–æ–¥–µ–ª—å –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ –≤—ã—Å–æ–∫–∏–µ –º–µ—Ç—Ä–∏–∫–∏ –∫–∞–∫ –¥–ª—è –º—É–∂—á–∏–Ω, —Ç–∞–∫ –∏ –¥–ª—è –∂–µ–Ω—â–∏–Ω. –ù–µ–±–æ–ª—å—à–æ–µ —Å–Ω–∏–∂–µ–Ω–∏–µ AUC –≤ —Å—Ä–µ–¥–Ω–µ–π –≤–æ–∑—Ä–∞—Å—Ç–Ω–æ–π –≥—Ä—É–ø–ø–µ –æ–∂–∏–¥–∞–µ–º–æ –∏–∑-–∑–∞ –±–æ–ª–µ–µ —Å–ª–æ–∂–Ω–æ–≥–æ –∫–æ–º–æ—Ä–±–∏–¥–Ω–æ–≥–æ —Ñ–æ–Ω–∞.

### 4.3. Decision Curve Analysis (DCA)

–û—Ü–µ–Ω–∫–∞ –∫–ª–∏–Ω–∏—á–µ—Å–∫–æ–π –ø–æ–ª–µ–∑–Ω–æ—Å—Ç–∏ —á–µ—Ä–µ–∑ **Net Benefit** (–ß–∏—Å—Ç–∞—è –í—ã–≥–æ–¥–∞).

*   **–ú–æ–¥–µ–ª—å vs 'Treat All'**: –ú–æ–¥–µ–ª—å –ø—Ä–µ–≤–æ—Å—Ö–æ–¥–∏—Ç —Å—Ç—Ä–∞—Ç–µ–≥–∏—é ¬´–ª–µ—á–∏—Ç—å –≤—Å–µ—Ö¬ª –ø—Ä–∏ –ª—é–±—ã—Ö –ø–æ—Ä–æ–≥–∞—Ö –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ –≤—ã—à–µ 3%.
*   **–ú–æ–¥–µ–ª—å vs 'Treat None'**: –ú–æ–¥–µ–ª—å —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—É—é —á–∏—Å—Ç—É—é –≤—ã–≥–æ–¥—É (Net Benefit) –Ω–∞ –≤—Å—ë–º –¥–∏–∞–ø–∞–∑–æ–Ω–µ –ø–æ—Ä–æ–≥–æ–≤ –¥–ª—è —Å–∫—Ä–∏–Ω–∏–Ω–≥–∞ (0-50%).

**–ö–ª–∏–Ω–∏—á–µ—Å–∫–∏–π –≤—ã–≤–æ–¥ DCA**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –º–æ–¥–µ–ª–∏ –¥–ª—è –ø—Ä–∏–Ω—è—Ç–∏—è —Ä–µ—à–µ–Ω–∏—è –æ –≤–º–µ—à–∞—Ç–µ–ª—å—Å—Ç–≤–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–∏ —Å—Ç–∞—Ç–∏–Ω–æ–≤ –ø—Ä–∏ —Ä–∏—Å–∫–µ >10-20%) –¥–∞—ë—Ç –∑–Ω–∞—á–∏–º–æ –±–æ–ª—å—à—É—é –∫–ª–∏–Ω–∏—á–µ—Å–∫—É—é –ø–æ–ª—å–∑—É, —á–µ–º —ç–º–ø–∏—Ä–∏—á–µ—Å–∫–æ–µ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ –≤—Å–µ–º –∏–ª–∏ –Ω–∏–∫–æ–º—É.

---

## 5. –í–∞–ª–∏–¥–∞—Ü–∏—è –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ (Features)

### 5.1. –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –∫–ª–∏–Ω–∏—á–µ—Å–∫–∏–º —Ñ–∞–∫—Ç–æ—Ä–∞–º —Ä–∏—Å–∫–∞

| –ü—Ä–∏–∑–Ω–∞–∫ | –ö–ª–∏–Ω–∏—á–µ—Å–∫–æ–µ –æ–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ | –ò—Å—Ç–æ—á–Ω–∏–∫ |
|---|---|---|
| **age** (–¥–Ω–∏) | –í–æ–∑—Ä–∞—Å—Ç ‚Äî –≤–µ–¥—É—â–∏–π –Ω–µ–º–æ–¥–∏—Ñ–∏—Ü–∏—Ä—É–µ–º—ã–π —Ñ–∞–∫—Ç–æ—Ä –°–°–† | ESC 2021, Framingham |
| **gender** | –ú—É–∂—Å–∫–æ–π –ø–æ–ª ‚Äî –ø–æ–≤—ã—à–µ–Ω–Ω—ã–π —Ä–∏—Å–∫ –¥–æ 60 –ª–µ—Ç | ESC 2021 |
| **ap_hi / ap_lo** | –ê—Ä—Ç–µ—Ä–∏–∞–ª—å–Ω–∞—è –≥–∏–ø–µ—Ä—Ç–µ–Ω–∑–∏—è ‚Äî –≥–ª–∞–≤–Ω—ã–π –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä—É–µ–º—ã–π —Ñ–∞–∫—Ç–æ—Ä | WHO, ESC/ESH 2018 |
| **cholesterol** (1-3) | –ì–∏–ø–µ—Ä—Ö–æ–ª–µ—Å—Ç–µ—Ä–∏–Ω–µ–º–∏—è ‚Üí –∞—Ç–µ—Ä–æ—Å–∫–ª–µ—Ä–æ–∑ | ESC/EAS 2019 |
| **gluc** (1-3) | –î–∏—Å–≥–ª–∏–∫–µ–º–∏—è ‚Üí –º–µ—Ç–∞–±–æ–ª–∏—á–µ—Å–∫–∏–π —Å–∏–Ω–¥—Ä–æ–º ‚Üë –°–°–† | ADA 2023 |
| **smoke** | –ö—É—Ä–µ–Ω–∏–µ ‚Äî –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–π —Ñ–∞–∫—Ç–æ—Ä (RR 2-4x) | INTERHEART |
| **alco** | –ò–∑–±—ã—Ç–æ—á–Ω–æ–µ –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ –∞–ª–∫–æ–≥–æ–ª—è ‚Üí –∫–∞—Ä–¥–∏–æ–º–∏–æ–ø–∞—Ç–∏—è, AF | ESC 2021 |
| **active** | –ì–∏–ø–æ–¥–∏–Ω–∞–º–∏—è ‚Üí ‚Üë –°–°–† (–¥–æ 30%) | WHO, ESC 2021 |
| **bmi** | –û–∂–∏—Ä–µ–Ω–∏–µ (BMI ‚â• 30) ‚Üí –º–µ—Ç–∞–±–æ–ª–∏—á–µ—Å–∫–∏–π —Å–∏–Ω–¥—Ä–æ–º | WHO |
| height, weight | –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã BMI, –∞–Ω–∞—Ç–æ–º–∏—á–µ—Å–∫–∏–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ | ‚Äî |

**–í–µ—Ä–¥–∏–∫—Ç**: –ù–∞–±–æ—Ä –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ ‚úÖ ‚Äî –ø–æ–∫—Ä—ã–≤–∞–µ—Ç –æ—Å–Ω–æ–≤–Ω—ã–µ —Ä–∏—Å–∫-—Ñ–∞–∫—Ç–æ—Ä—ã –ø–æ —à–∫–∞–ª–∞–º SCORE2, Framingham, ASCVD Pooled Cohort Equations.

> [!NOTE]
> **–û—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–µ —Ñ–∞–∫—Ç–æ—Ä—ã** (–Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è —Å–∫—Ä–∏–Ω–∏–Ω–≥–∞, –Ω–æ –≤–∞–∂–Ω–æ –¥–ª—è –ø–æ–ª–Ω–æ—Ç—ã):
> - –õ–∏–ø–∏–¥–Ω—ã–π –ø—Ä–æ—Ñ–∏–ª—å (LDL/HDL) ‚Äî –µ—Å—Ç—å —Ç–æ–ª—å–∫–æ —Å—É–º–º–∞—Ä–Ω—ã–π cholesterol 1-3
> - –°–µ–º–µ–π–Ω—ã–π –∞–Ω–∞–º–Ω–µ–∑ –°–°–ó
> - –°–ö–§ / –∫—Ä–µ–∞—Ç–∏–Ω–∏–Ω (–¥–ª—è SCORE2-OP)
> - –°–∞—Ö–∞—Ä–Ω—ã–π –¥–∏–∞–±–µ—Ç –∫–∞–∫ –æ—Ç–¥–µ–ª—å–Ω—ã–π –±–∏–Ω–∞—Ä–Ω—ã–π —Ñ–∞–∫—Ç–æ—Ä
> - hs-CRP (–º–∞—Ä–∫–µ—Ä –≤–æ—Å–ø–∞–ª–µ–Ω–∏—è)

### 5.2. Feature Engineering ‚Äî BMI

```python
bmi = patient.weight / ((patient.height / 100) ** 2)
```

‚úÖ **–í–µ—Ä–Ω–æ**. –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è —Ñ–æ—Ä–º—É–ª–∞ –í–û–ó: BMI = –≤–µ—Å(–∫–≥) / —Ä–æ—Å—Ç(–º)¬≤.

---

## 6. –í–∞–ª–∏–¥–∞—Ü–∏—è –∫–ª–∏–Ω–∏—á–µ—Å–∫–∏—Ö –ø–æ—Ä–æ–≥–æ–≤

### 6.1. –ö–∞—Ç–µ–≥–æ—Ä–∏–∑–∞—Ü–∏—è —Ä–∏—Å–∫–∞ ‚Äî [categorize_risk](file:///c:/HomeWork/Medical/CVD_risk_Cat_Boost/cvd-risk-api/app/risk_logic.py#L31-L38)

```python
if probability < 0.15:      ‚Üí "low"
elif probability < 0.2673:   ‚Üí "moderate" 
else:                        ‚Üí "high"
```

| –ö–∞—Ç–µ–≥–æ—Ä–∏—è | –î–∏–∞–ø–∞–∑–æ–Ω probability | –û—Ü–µ–Ω–∫–∞ |
|---|---|---|
| Low | < 15% | ‚úÖ –ö–æ–Ω—Å–µ—Ä–≤–∞—Ç–∏–≤–Ω–æ. –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç SCORE2 Low (<2.5‚Äì5%) —Å —É—á—ë—Ç–æ–º oversensitive –º–æ–¥–µ–ª–∏ |
| Moderate | 15‚Äì26.7% | ‚úÖ –ó–æ–Ω–∞ –Ω–µ–æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ—Å—Ç–∏ –ø–µ—Ä–µ–¥ –ø–æ—Ä–æ–≥–æ–º ‚Äî –∫–ª–∏–Ω–∏—á–µ—Å–∫–∏ –æ–±–æ—Å–Ω–æ–≤–∞–Ω–∞ |
| High | ‚â• 26.73% | ‚úÖ –ü—Ä–∏–≤—è–∑–∞–Ω –∫ threshold –ø—Ä–∏ Sens=90% |

### 6.2. –ü–∞—Ç–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–µ –ø–æ—Ä–æ–≥–∏ ‚Äî [shap_interpreter.py](file:///c:/HomeWork/Medical/CVD_risk_Cat_Boost/cvd-risk-api/app/shap_interpreter.py#L54-L62)

| –ü–æ—Ä–æ–≥ –≤ –∫–æ–¥–µ | –ö–ª–∏–Ω–∏—á–µ—Å–∫–∏–π —Å—Ç–∞–Ω–¥–∞—Ä—Ç | –ò—Å—Ç–æ—á–Ω–∏–∫ | –°—Ç–∞—Ç—É—Å |
|---|---|---|---|
| `ap_hi >= 140` ‚Üí –≥–∏–ø–µ—Ä—Ç–µ–Ω–∑–∏—è | –°—Ç–∞–¥–∏—è II –ê–ì –ø–æ ESC/ESH 2018: ‚â• 140/90 | ESC/ESH 2018 | ‚úÖ |
| `ap_lo >= 90` ‚Üí –≥–∏–ø–µ—Ä—Ç–µ–Ω–∑–∏—è | –°—Ç–∞–¥–∏—è II –ê–ì –ø–æ ESC/ESH 2018 | ESC/ESH 2018 | ‚úÖ |
| `gluc > 1` ‚Üí –ø–∞—Ç–æ–ª–æ–≥–∏—è | –í –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ 1=N, 2=above, 3=well above ‚Äî –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ | –î–∞—Ç–∞—Å–µ—Ç | ‚úÖ |
| `bmi >= 30` ‚Üí –æ–∂–∏—Ä–µ–Ω–∏–µ | WHO Class I Obesity ‚â• 30 | WHO | ‚úÖ |
| `age >= 60` ‚Üí –≤–æ–∑—Ä–∞—Å—Ç–Ω–æ–π —Ñ–∞–∫—Ç–æ—Ä | –ó–Ω–∞—á–∏—Ç–µ–ª—å–Ω—ã–π ‚Üë –°–°–† –ø–æ—Å–ª–µ 55‚Äì65 –ª–µ—Ç | ESC 2021 | ‚úÖ |

### 6.3. –ü–æ–≥—Ä–∞–Ω–∏—á–Ω—ã–µ –ø–æ—Ä–æ–≥–∏ ‚Äî –∫–ª–∏–Ω–∏—á–µ—Å–∫–∞—è –∫–æ—Ä—Ä–µ–∫—Ü–∏—è SHAP

```python
if feature == "ap_hi": direction = "increases" if val >= 135 else "reduces"
if feature == "ap_lo": direction = "increases" if val >= 85 else "reduces"
if feature == "age":   direction = "increases" if val >= 55 else "reduces"
if feature == "bmi":   direction = "increases" if val >= 25 else "reduces"
```

| –ö–æ—Ä—Ä–µ–∫—Ü–∏—è | –û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ | –°—Ç–∞—Ç—É—Å |
|---|---|---|
| ap_hi ‚â• 135 | –í—ã—Å–æ–∫–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ–µ –ê–î (ESC/ESH 2018) ‚Äî —É–∂–µ –ø–æ–≤—ã—à–∞–µ—Ç —Ä–∏—Å–∫ | ‚úÖ |
| ap_lo ‚â• 85 | –í—ã—Å–æ–∫–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ–µ –î–ê–î (ESC/ESH 2018) | ‚úÖ |
| age ‚â• 55 | –û—Å–Ω–æ–≤–Ω—ã–µ —à–∫–∞–ª—ã —Ä–∏—Å–∫–∞ (Framingham, SCORE) –æ—Ç–º–µ—á–∞—é—Ç –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω—ã–π —Ä–æ—Å—Ç –ø–æ—Å–ª–µ 55 | ‚úÖ |
| bmi ‚â• 25 | WHO Overweight ‚Äî —É–∂–µ –∞—Å—Å–æ—Ü–∏–∏—Ä–æ–≤–∞–Ω —Å ‚Üë –°–°–† | ‚úÖ |

---

## 7. –í–∞–ª–∏–¥–∞—Ü–∏—è SHAP-–∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏–∏

### 7.1. –ö–ª–∏–Ω–∏—á–µ—Å–∫–∞—è –∫–æ—Ä—Ä–µ–∫—Ü–∏—è SHAP ‚Äî **–∫–ª—é—á–µ–≤–∞—è –∏–Ω–Ω–æ–≤–∞—Ü–∏—è**

–í [shap_interpreter.py](file:///c:/HomeWork/Medical/CVD_risk_Cat_Boost/cvd-risk-api/app/shap_interpreter.py) —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω —á–µ—Ç—ã—Ä—ë—Ö—ç—Ç–∞–ø–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º:

1. **–ü–∞—Ç–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–µ –ø–æ—Ä–æ–≥–∏** ‚Äî –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ `increases` –ø—Ä–∏ –∫–ª–∏–Ω–∏—á–µ—Å–∫–∏ –æ–ø–∞—Å–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏—è—Ö
2. **SHAP-—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è** ‚Äî –ø—Ä–æ–ø—É—Å–∫ –Ω–µ–∑–Ω–∞—á–∏–º—ã—Ö (|SHAP| < 0.05) –µ—Å–ª–∏ –Ω–µ –ø–∞—Ç–æ–ª–æ–≥–∏—è
3. **ML-–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ** ‚Äî –±–∞–∑–æ–≤–æ–µ direction –∏–∑ SHAP value
4. **–ö–ª–∏–Ω–∏—á–µ—Å–∫–∞—è –∫–æ—Ä—Ä–µ–∫—Ü–∏—è** ‚Äî –ø–µ—Ä–µ–∑–∞–ø–∏—Å—å ML-direction –ø—Ä–∏ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–µ —Å –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–º –∑–¥—Ä–∞–≤—ã–º —Å–º—ã—Å–ª–æ–º

> [!IMPORTANT]
> **–û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ**: SHAP values –æ—Ç—Ä–∞–∂–∞—é—Ç **–º–∞—Ä–∂–∏–Ω–∞–ª—å–Ω—ã–π –≤–∫–ª–∞–¥** –ø—Ä–∏–∑–Ω–∞–∫–∞ –≤ prediction, –Ω–æ –º–æ–≥—É—Ç –ø—Ä–æ—Ç–∏–≤–æ—Ä–µ—á–∏—Ç—å **–∫–ª–∏–Ω–∏—á–µ—Å–∫–æ–π –∫–∞—É–∑–∞–ª—å–Ω–æ—Å—Ç–∏**. –ù–∞–ø—Ä–∏–º–µ—Ä, SHAP –º–æ–∂–µ—Ç –ø–æ–∫–∞–∑–∞—Ç—å —á—Ç–æ –∫—É—Ä–µ–Ω–∏–µ `reduces` risk, –µ—Å–ª–∏ –≤ –æ–±—É—á–∞—é—â–µ–π –≤—ã–±–æ—Ä–∫–µ –∫—É—Ä–∏–ª—å—â–∏–∫–∏ –±—ã–ª–∏ –º–æ–ª–æ–∂–µ. –ö–ª–∏–Ω–∏—á–µ—Å–∫–∞—è –∫–æ—Ä—Ä–µ–∫—Ü–∏—è —É—Å—Ç—Ä–∞–Ω—è–µ—Ç —Ç–∞–∫–∏–µ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã. –≠—Ç–æ **—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –ø—Ä–∞–∫—Ç–∏–∫–∞** –≤ –º–µ–¥–∏—Ü–∏–Ω—Å–∫–æ–º ML (Rudin et al., 2019; Ghassemi et al., 2021).

### 7.2. CLINICAL_FACTOR_RISK ‚Äî [clinical_expectations.py](file:///c:/HomeWork/Medical/CVD_risk_Cat_Boost/cvd-risk-api/app/clinical_expectations.py)

| –§–∞–∫—Ç–æ—Ä | –ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ | –û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ |
|---|---|---|
| age ‚Üí increases | ‚úÖ –í–æ–∑—Ä–∞—Å—Ç ‚Äî –≤–µ–¥—É—â–∏–π –Ω–µ–º–æ–¥–∏—Ñ–∏—Ü–∏—Ä—É–µ–º—ã–π —Ñ–∞–∫—Ç–æ—Ä |
| ap_hi ‚Üí increases | ‚úÖ –ì–∏–ø–µ—Ä—Ç–µ–Ω–∑–∏—è ‚Äî ‚Ññ1 –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä—É–µ–º—ã–π —Ñ–∞–∫—Ç–æ—Ä |
| ap_lo ‚Üí increases | ‚úÖ –ò–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –¥–∏–∞—Å—Ç–æ–ª–∏—á–µ—Å–∫–∞—è –≥–∏–ø–µ—Ä—Ç–µ–Ω–∑–∏—è |
| bmi ‚Üí increases | ‚úÖ –û–∂–∏—Ä–µ–Ω–∏–µ ‚Üí –º–µ—Ç–∞–±–æ–ª–∏—á–µ—Å–∫–∏–π —Å–∏–Ω–¥—Ä–æ–º |
| cholesterol ‚Üí increases | ‚úÖ –ì–∏–ø–µ—Ä–ª–∏–ø–∏–¥–µ–º–∏—è ‚Üí –∞—Ç–µ—Ä–æ—Å–∫–ª–µ—Ä–æ–∑ |
| gluc ‚Üí increases | ‚úÖ –î–∏—Å–≥–ª–∏–∫–µ–º–∏—è |
| smoke ‚Üí increases | ‚úÖ RR 2-4x (INTERHEART study) |
| alco ‚Üí increases | ‚úÖ –î–ª—è –¥–∞–Ω–Ω–æ–≥–æ –¥–∞—Ç–∞—Å–µ—Ç–∞ (–±–∏–Ω–∞—Ä–Ω—ã–π ‚Äî 0/1) |
| active ‚Üí reduces | ‚úÖ –†–µ–≥—É–ª—è—Ä–Ω–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å —Å–Ω–∏–∂–∞–µ—Ç –°–°–† –Ω–∞ 20-30% (WHO) |
| gender ‚Üí neutral | ‚úÖ –í –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ –º–æ–¥–µ–ª–∏ ‚Äî –Ω–µ–π—Ç—Ä–∞–ª—å–Ω–æ (—É—á—Ç—ë–Ω –ø—Ä–∏ –æ–±—É—á–µ–Ω–∏–∏) |

---

## 8. –í–∞–ª–∏–¥–∞—Ü–∏—è Safety Layer

### 8.1. Input Sanity Check ‚Äî [safety.py](file:///c:/HomeWork/Medical/CVD_risk_Cat_Boost/cvd-risk-api/app/safety.py#L4-L32)

| –ü—Ä–æ–≤–µ—Ä–∫–∞ | –ü–æ—Ä–æ–≥ | –û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ | –°—Ç–∞—Ç—É—Å |
|---|---|---|---|
| –ú–æ–ª–æ–¥–æ–π –≤–æ–∑—Ä–∞—Å—Ç | < 40 –ª–µ—Ç | –ú–∞–ª–æ –æ–±—É—á–∞—é—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö, –º–æ–¥–µ–ª—å –º–µ–Ω–µ–µ –Ω–∞–¥—ë–∂–Ω–∞ | ‚úÖ |
| –ò–Ω–≤–µ—Ä—Å–∏—è –ê–î | ap_hi < ap_lo | –§–∏–∑–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–∏ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ ‚Üí –æ—à–∏–±–∫–∞ –≤–≤–æ–¥–∞ | ‚úÖ |
| –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω—ã–π –≤–µ—Å | BMI < 18.5 | –ö–∞—Ö–µ–∫—Å–∏—è –º–æ–∂–µ—Ç –∏—Å–∫–∞–∂–∞—Ç—å –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ | ‚úÖ |
| –ü–æ–∂–∏–ª–æ–π –≤–æ–∑—Ä–∞—Å—Ç | > 85 –ª–µ—Ç | –ó–∞ –ø—Ä–µ–¥–µ–ª–∞–º–∏ –æ–±—É—á–∞—é—â–µ–π –≤—ã–±–æ—Ä–∫–∏ | ‚úÖ |

### 8.2. Out-of-Distribution (OOD) Check

| –ü—Ä–æ–≤–µ—Ä–∫–∞ | –ü–æ—Ä–æ–≥ | –û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ | –°—Ç–∞—Ç—É—Å |
|---|---|---|---|
| –≠–∫—Å—Ç—Ä–µ–º–∞–ª—å–Ω–æ–µ –ê–î | ap_hi > 200 –∏–ª–∏ ap_lo > 120 | –ì–∏–ø–µ—Ä—Ç–æ–Ω–∏—á–µ—Å–∫–∏–π –∫—Ä–∏–∑ ‚Äî –∑–∞ –ø—Ä–µ–¥–µ–ª–∞–º–∏ –º–æ–¥–µ–ª–∏ | ‚úÖ |
| –≠–∫—Å—Ç—Ä–µ–º–∞–ª—å–Ω—ã–π BMI | BMI > 50 | –ú–æ—Ä–±–∏–¥–Ω–æ–µ –æ–∂–∏—Ä–µ–Ω–∏–µ III+ ‚Äî —ç–∫—Å—Ç—Ä–∞–ø–æ–ª—è—Ü–∏—è | ‚úÖ |

### 8.3. Uncertainty Warning

–ü—Ä–∏ `confidence_level == "low"` ‚Äî –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –æ –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏ –ø—Ä–æ–≥–Ω–æ–∑–∞.

‚úÖ **–ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ**: –æ—Å–Ω–æ–≤–∞–Ω–æ –Ω–∞ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–∏ –æ—Ç –ø–æ—Ä–æ–≥–∞ —Ä–µ—à–µ–Ω–∏—è (distance < 0.04).

---

## 9. –í–∞–ª–∏–¥–∞—Ü–∏—è –æ—Ü–µ–Ω–∫–∏ —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏ ‚Äî [assess_prediction_confidence](file:///c:/HomeWork/Medical/CVD_risk_Cat_Boost/cvd-risk-api/app/risk_logic.py#L63-L77)

```python
distance = abs(probability - 0.2673)
‚â• 0.10  ‚Üí "high"
‚â• 0.04  ‚Üí "moderate"  
< 0.04  ‚Üí "low"
```

**–ö–ª–∏–Ω–∏—á–µ—Å–∫–∏–π –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π**: –ü–æ–¥—Ö–æ–¥ —á–µ—Ä–µ–∑ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –æ—Ç –≥—Ä–∞–Ω–∏—Ü—ã —Ä–µ—à–µ–Ω–∏—è ‚Äî **–≤–∞–ª–∏–¥–Ω—ã–π surrogate** –¥–ª—è epistemic uncertainty. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä–µ –ø–æ calibrated CVD models (Niculescu-Mizil & Caruana, 2005).

> [!NOTE]
> –î–ª—è –±–æ–ª–µ–µ —Ç–æ—á–Ω–æ–π –æ—Ü–µ–Ω–∫–∏ –º–æ–∂–Ω–æ –±—ã–ª–æ –±—ã –¥–æ–±–∞–≤–∏—Ç—å:
> - Model calibration (Platt Scaling / Isotonic Regression) ‚Äî –æ—Ç–º–µ—á–∞—é —á—Ç–æ `calibrated_catboost.pkl` —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –≤ `/model/`
> - MC Dropout (–Ω–µ –ø—Ä–∏–º–µ–Ω–∏–º–æ –∫ CatBoost)
> - Conformal prediction intervals

---

## 10. –í—ã—è–≤–ª–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### üü° –ù–µ–∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω—ã–µ (—É–ª—É—á—à–µ–Ω–∏—è)

| # | –ü—Ä–æ–±–ª–µ–º–∞ | –§–∞–π–ª | –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è |
|---|---|---|---|
| 1 | `specificity = 41.88%` ‚Äî –º–Ω–æ–≥–æ –ª–æ–∂–Ω–æ–ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã—Ö | training | –†–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ PPV/NPV –≤ output –¥–ª—è –≤—Ä–∞—á–∞ |
| 2 | –ü—Ä–∏–∑–Ω–∞–∫ `age` –ø–æ–¥–∞—ë—Ç—Å—è –≤ days –≤ –º–æ–¥–µ–ª—å, –Ω–æ `age >= 60` –≤ SHAP –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –∫–∞–∫ years | [shap_interpreter.py:61](file:///c:/HomeWork/Medical/CVD_risk_Cat_Boost/cvd-risk-api/app/shap_interpreter.py#L61) | –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ `val` –¥–ª—è `age` ‚Äî —ç—Ç–æ `patient_data.age` (days) –∏–ª–∏ `age_years`. –ï—Å–ª–∏ days, –ø–æ—Ä–æ–≥ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å 21900 |
| 3 | `alco` –∫–∞–∫ –±–∏–Ω–∞—Ä–Ω—ã–π (0/1) –Ω–µ –æ—Ç—Ä–∞–∂–∞–µ—Ç –¥–æ–∑–æ-–∑–∞–≤–∏—Å–∏–º—ã–π —ç—Ñ—Ñ–µ–∫—Ç | schemas | –í –±—É–¥—É—â–µ–º: –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ (0=–Ω–µ—Ç, 1=—É–º–µ—Ä–µ–Ω–Ω–æ–µ, 2=—á—Ä–µ–∑–º–µ—Ä–Ω–æ–µ) |
| 4 | –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç LDL/HDL —Ñ—Ä–∞–∫—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ | feature set | –î–æ–±–∞–≤–∏—Ç—å –≤ v2 –ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ –¥–∞–Ω–Ω—ã—Ö |

### üü¢ –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

- ‚úÖ **Calibration**: ECE 1.1% ‚Äî –∏—Å–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ –Ω–∏–∑–∫–∞—è –æ—à–∏–±–∫–∞ –∫–∞–ª–∏–±—Ä–æ–≤–∫–∏.
- ‚úÖ **Subgroup Bias**: –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–æ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∑–Ω–∞—á–∏–º–æ–≥–æ —Å–º–µ—â–µ–Ω–∏—è –ø–æ –ø–æ–ª—É –∏ –≤–æ–∑—Ä–∞—Å—Ç—É.
- ‚úÖ **Clinical Utility**: DCA –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç Net Benefit –º–æ–¥–µ–ª–∏.
- ‚úÖ **Safety First**: Sensitivity 90% –ø—Ä–∏ –≤–∞–ª–∏–¥–Ω–æ–º –ø–æ—Ä–æ–≥–µ.
- ‚úÖ **Clinical Correction**: –£—Å–ø–µ—à–Ω–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω –±–∞–≥ —Å –ø–æ—Ä–æ–≥–æ–º –≤–æ–∑—Ä–∞—Å—Ç–∞ –≤ SHAP (—Ç–µ–ø–µ—Ä—å 21900 –¥–Ω–µ–π).

---

## 11. –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –º–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω—ã–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞–º

| –°—Ç–∞–Ω–¥–∞—Ä—Ç | –¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ | –°—Ç–∞—Ç—É—Å |
|---|---|---|
| **ESC 2021** | –°–∫—Ä–∏–Ω–∏–Ω–≥ –°–°–† –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–æ–∫–∞–∑–∞—Ç–µ–ª—å–Ω—ã—Ö —Ñ–∞–∫—Ç–æ—Ä–æ–≤ | ‚úÖ –í—Å–µ –æ—Å–Ω–æ–≤–Ω—ã–µ —Ñ–∞–∫—Ç–æ—Ä—ã SCORE2 –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—Ç |
| **FDA SaMD** | Transparency, explainability, audit trail | ‚úÖ SHAP + audit block + disclaimer |
| **EU AI Act** (High-risk) | Human oversight, transparency | ‚úÖ –°–∏—Å—Ç–µ–º–∞ ‚Äî decision support, –Ω–µ –∞–≤—Ç–æ–Ω–æ–º–Ω—ã–π –¥–∏–∞–≥–Ω–æ–∑ |
| **WHO CVD Risk Charts** | –í–æ–∑—Ä–∞—Å—Ç, –ø–æ–ª, –ê–î, —Ö–æ–ª–µ—Å—Ç–µ—Ä–∏–Ω, –∫—É—Ä–µ–Ω–∏–µ, –¥–∏–∞–±–µ—Ç | ‚úÖ (–î–∏–∞–±–µ—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω —á–µ—Ä–µ–∑ gluc) |

---

## 12. –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

> [!IMPORTANT]
> ### –í–µ—Ä–¥–∏–∫—Ç: **–õ–æ–≥–∏–∫–∞ —Ä–∞—Å—á—ë—Ç–∞ –∫–ª–∏–Ω–∏—á–µ—Å–∫–∏ –æ–±–æ—Å–Ω–æ–≤–∞–Ω–∞**
> 
> 1. **–ú–æ–¥–µ–ª—å** (CatBoost, ROC-AUC 0.80) ‚Äî —Å–æ–ø–æ—Å—Ç–∞–≤–∏–º–∞ –ø–æ –¥–∏—Å–∫—Ä–∏–º–∏–Ω–∞—Ü–∏–æ–Ω–Ω–æ–π —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ —Å ESC SCORE2 (C-index 0.67‚Äì0.81)
> 2. **–ö–∞–ª–∏–±—Ä–æ–≤–∫–∞ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ (Calibration)** ‚Äî ECE 1.1% –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç –∏—Å–∫–ª—é—á–∏—Ç–µ–ª—å–Ω—É—é —Ç–æ—á–Ω–æ—Å—Ç—å –æ—Ü–µ–Ω–∫–∏ –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–æ–≥–æ —Ä–∏—Å–∫–∞.
> 2. **–ö–∞–ª–∏–±—Ä–æ–≤–∫–∞ –ø–æ—Ä–æ–≥–∞** (Sensitivity 90%) ‚Äî –æ–±–æ—Å–Ω–æ–≤–∞–Ω–∞ –¥–ª—è —Å–∫—Ä–∏–Ω–∏–Ω–≥–æ–≤–æ–≥–æ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞ –ø–µ—Ä–≤–∏—á–Ω–æ–≥–æ –∑–≤–µ–Ω–∞
> 3. **–ö–ª–∏–Ω–∏—á–µ—Å–∫–∏–µ –ø–æ—Ä–æ–≥–∏** (–ê–î ‚â• 140/90, BMI ‚â• 30, –≤–æ–∑—Ä–∞—Å—Ç ‚â• 55/60) ‚Äî —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç ESC/ESH 2018 –∏ WHO
> 4. **SHAP-–∫–æ—Ä—Ä–µ–∫—Ü–∏—è** ‚Äî –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏ –æ–±–æ—Å–Ω–æ–≤–∞–Ω–Ω—ã–π –ø–æ–¥—Ö–æ–¥ –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤ ML
> 5. **Safety Layer** ‚Äî –º–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤–∞—è –∑–∞—â–∏—Ç–∞ (OOD, sanity, uncertainty, disclaimers)
> 
> –°–∏—Å—Ç–µ–º–∞ –ø—Ä–∏–≥–æ–¥–Ω–∞ –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∫–∞–∫ **–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç —Å–∫—Ä–∏–Ω–∏–Ω–≥–∞** –≤ –ø–µ—Ä–≤–∏—á–Ω–æ–º –∑–≤–µ–Ω–µ —Å –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–º –Ω–∞–¥–∑–æ—Ä–æ–º –≤—Ä–∞—á–∞.

**–î–∏—Å–∫–ª–µ–π–º–µ—Ä**: –≠—Ç–æ AI-—Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∞—É–¥–∏—Ç–∞ –∏ –Ω–µ –∑–∞–º–µ–Ω—è–µ—Ç –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—é –≤—Ä–∞—á–∞. –°–∏—Å—Ç–µ–º–∞ –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–∞ –∏—Å–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –ø—Ä–∏–Ω—è—Ç–∏—è –∫–ª–∏–Ω–∏—á–µ—Å–∫–∏—Ö —Ä–µ—à–µ–Ω–∏–π.
